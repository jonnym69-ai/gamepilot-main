"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.IdentityTimeline = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const IdentityTimeline = ({ snapshots, onRegenerateCard, onDelete }) => {
    const [expandedItems, setExpandedItems] = (0, react_1.useState)(new Set());
    const toggleExpanded = (id) => {
        const newExpanded = new Set(expandedItems);
        if (newExpanded.has(id)) {
            newExpanded.delete(id);
        }
        else {
            newExpanded.add(id);
        }
        setExpandedItems(newExpanded);
    };
    const formatDate = (timestamp) => {
        return new Date(timestamp).toLocaleDateString();
    };
    const formatTime = (timestamp) => {
        return new Date(timestamp).toLocaleTimeString();
    };
    if (!snapshots || snapshots.length === 0) {
        return ((0, jsx_runtime_1.jsxs)("div", { className: "identity-history-empty", children: [(0, jsx_runtime_1.jsx)("div", { className: "empty-state-icon", children: "\uD83D\uDCCA" }), (0, jsx_runtime_1.jsx)("h3", { children: "No Identity History Yet" }), (0, jsx_runtime_1.jsx)("p", { children: "Your gaming identity will evolve as you play. Start tracking your gaming sessions to see your identity timeline here." })] }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: "identity-timeline", children: [(0, jsx_runtime_1.jsxs)("div", { className: "timeline-header", children: [(0, jsx_runtime_1.jsx)("h2", { children: "Your Identity Timeline" }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-stats", children: [(0, jsx_runtime_1.jsxs)("div", { className: "timeline-stat", children: [(0, jsx_runtime_1.jsx)("div", { className: "timeline-stat-number", children: snapshots.length }), (0, jsx_runtime_1.jsx)("div", { className: "timeline-stat-label", children: "Snapshots" })] }), snapshots.length > 1 && ((0, jsx_runtime_1.jsxs)("div", { className: "timeline-stat", children: [(0, jsx_runtime_1.jsx)("div", { className: "timeline-stat-number", children: snapshots.length > 1 ?
                                            Math.round((snapshots[0].timestamp ?
                                                (new Date().getTime() - new Date(snapshots[0].timestamp).getTime()) /
                                                    (1000 * 60 * 60 * 24)
                                                : 0)) : 0 }), (0, jsx_runtime_1.jsx)("div", { className: "timeline-stat-label", children: "Days Ago" })] }))] })] }), (0, jsx_runtime_1.jsx)("div", { className: "timeline", children: snapshots.map((snapshot, index) => ((0, jsx_runtime_1.jsxs)("div", { className: "timeline-item", children: [(0, jsx_runtime_1.jsx)("div", { className: "timeline-dot", children: (0, jsx_runtime_1.jsx)("div", { className: "timeline-dot-inner" }) }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-content", children: [(0, jsx_runtime_1.jsxs)("div", { className: "timeline-header", children: [(0, jsx_runtime_1.jsxs)("div", { className: "timeline-date", children: [(0, jsx_runtime_1.jsx)("div", { className: "timeline-date-text", children: formatDate(snapshot.timestamp) }), (0, jsx_runtime_1.jsx)("div", { className: "timeline-time-text", children: formatTime(snapshot.timestamp) })] }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-actions", children: [(0, jsx_runtime_1.jsx)("button", { onClick: () => toggleExpanded(snapshot.id), className: "timeline-toggle-btn", children: expandedItems.has(snapshot.id) ? 'Collapse' : 'Expand' }), (0, jsx_runtime_1.jsx)("button", { onClick: () => onRegenerateCard(snapshot), className: "timeline-regenerate-btn", children: "Regenerate Card" }), (0, jsx_runtime_1.jsx)("button", { onClick: () => onDelete(snapshot.id), className: "timeline-delete-btn", children: "Delete" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-summary", children: [(0, jsx_runtime_1.jsx)("h3", { children: snapshot.shortNarrative }), (0, jsx_runtime_1.jsx)("div", { className: "timeline-moods", children: snapshot.dominantMoods.slice(0, 3).map(mood => ((0, jsx_runtime_1.jsx)("span", { className: "timeline-mood-tag", children: mood }, mood))) })] }), expandedItems.has(snapshot.id) && ((0, jsx_runtime_1.jsx)("div", { className: "timeline-expanded", children: (0, jsx_runtime_1.jsxs)("div", { className: "timeline-expanded-details", children: [(0, jsx_runtime_1.jsxs)("div", { className: "timeline-section", children: [(0, jsx_runtime_1.jsx)("h4", { children: "Gaming Moods" }), (0, jsx_runtime_1.jsx)("div", { className: "timeline-moods-grid", children: snapshot.dominantMoods.map(mood => ((0, jsx_runtime_1.jsx)("div", { className: "timeline-mood-item", children: (0, jsx_runtime_1.jsx)("span", { children: mood }) }, mood))) })] }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-section", children: [(0, jsx_runtime_1.jsx)("h4", { children: "Gaming Stats" }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-stats-grid", children: [(0, jsx_runtime_1.jsxs)("div", { className: "timeline-stat-item", children: [(0, jsx_runtime_1.jsx)("div", { className: "timeline-stat-label", children: "Completion Rate" }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-stat-value", children: [Math.round(snapshot.completionRate * 100), "%"] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-stat-item", children: [(0, jsx_runtime_1.jsx)("div", { className: "timeline-stat-label", children: "Social Gaming" }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-stat-value", children: [Math.round(snapshot.multiplayerRatio * 100), "%"] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-stat-item", children: [(0, jsx_runtime_1.jsx)("div", { className: "timeline-stat-label", children: "Avg Session" }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-stat-value", children: [Math.round(snapshot.averageSessionLengthMinutes), " min"] })] })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-section", children: [(0, jsx_runtime_1.jsx)("h4", { children: "Top Games" }), (0, jsx_runtime_1.jsx)("div", { className: "timeline-games-list", children: snapshot.topIdentityGames.map((game, gameIndex) => ((0, jsx_runtime_1.jsxs)("div", { className: "timeline-game-item", children: [(0, jsx_runtime_1.jsxs)("div", { className: "timeline-game-rank", children: ["#", gameIndex + 1] }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-game-info", children: [(0, jsx_runtime_1.jsx)("div", { className: "timeline-game-title", children: game.title }), (0, jsx_runtime_1.jsxs)("div", { className: "timeline-game-score", children: ["Score: ", game.score.toFixed(1)] })] })] }, game.id))) })] }), snapshot.fullNarrative && ((0, jsx_runtime_1.jsxs)("div", { className: "timeline-section", children: [(0, jsx_runtime_1.jsx)("h4", { children: "Full Story" }), (0, jsx_runtime_1.jsx)("div", { className: "timeline-full-narrative", children: (0, jsx_runtime_1.jsx)("p", { children: snapshot.fullNarrative }) })] }))] }) }))] })] }, snapshot.id))) })] }));
};
exports.IdentityTimeline = IdentityTimeline;
